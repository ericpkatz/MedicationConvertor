<!DOCTYPE html>
<html>
<head>
    <title>Opioid Convertor</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="Content/jquery.mobile-1.2.0.css" rel="stylesheet" type="text/css" />
    <script src="Scripts/jquery-1.6.4.js" type="text/javascript"></script>
    <script src="Scripts/jquery.mobile-1.2.0.js" type="text/javascript"></script>
    <script src="Scripts/mustache.js" type="text/javascript"></script>
    <!--    TO DO - ADD CHANGES
    MAKE THE BUTTON THAT IS CLICKED ON SELECTED
    PRESELECT ITEM
    IF PRESELECTED IS DISABLED - THEN GET CLOSEST ONE
-->
    <script>

        $(function () {
            $("input[name=r]").click(function () {
                var picker = $("#picker");
                var template = $("#template-picker").html();
                var data = {
                    threshold: $(this).val(),
                    enabledList: function () {
                        var that = this;
                        var found = false;
                        var arr = $(order).map(function (index, item) {
                            if (item == that.threshold)
                                found = true;
                            if (found)
                                return item;
                        });
                        return arr;
                    },
                    isDisabled: function () {
                        return function (val) {
                            if ($.grep(this.enabledList(), function (item) {
                                return item == val
                            }).length == 0)
                                return "disabled=disabled";
                        }
                    }
                };
                var html = Mustache.to_html(template, data);
                picker.html(html);
                //$("input:button[value='q.12 h']", this).attr("disabled", "disabled");
                picker.trigger("create");
            });
            var order = ["q.1 d", "q.12 h", "q.8 h", "q.6 h", "q.4 h", "q.3 h", "q.2 h", "q.1 h"];
            $("#picker input:button").live("click", function () {
                $("#picker input:button").buttonMarkup({ theme: "c" }).button("refresh");
                $(this).buttonMarkup({ theme: "e" }).button("refresh");
                //$(this).trigger("refresh");
            });
            $("#Proposed").bind("pagebeforeshow", function () {
                var picker = $("#picker", this);
                var template = $("#template-picker").html();
                var data = {
                    threshold: "q.1 d",
                    enabledList: function () {
                        var that = this;
                        var found = false;
                        var arr = $(order).map(function (index, item) {
                            if (item == that.threshold)
                                found = true;
                            if (found)
                                return item;
                        });
                        return arr;
                    },
                    isDisabled: function () {
                        return function (val) {
                            if ($.grep(this.enabledList(), function (item) {
                                return item == val
                            }).length == 0)
                                return "disabled=disabled";
                        }
                    }
                };
                var html = Mustache.to_html(template, data);
                picker.html(html);
                //$("input:button[value='q.12 h']", this).attr("disabled", "disabled");
                picker.trigger("create");
            });
        });

    </script>
</head>
<body>
    <section data-role="page" id="Existing">
        <section data-role="header">
            <h1>
                Header</h1>
        </section>
        <section data-role="content">
            <div data-role="navbar">
                <ul>
                    <li><a href="#Existing" class="ui-btn-active ui-state-persist">Existing</a></li>
                    <li><a href="#Proposed">Proposed</a></li>
                </ul>
            </div>
<div data-role="fieldcontain">
    <fieldset data-role="controlgroup">
    	<legend>Choose a pet:</legend>
         	<input type="radio" name="radio-choice-1" id="radio-choice-1" value="choice-1" checked="checked" />
         	<label for="radio-choice-1">Cat</label>

         	<input type="radio" name="radio-choice-1" id="radio-choice-2" value="choice-2" disabled="disabled"/>
         	<label for="radio-choice-2">Dog</label>

         	<input type="radio" name="radio-choice-1" id="radio-choice-3" value="choice-3"  />
         	<label for="radio-choice-3">Hamster</label>

         	<input type="radio" name="radio-choice-1" id="radio-choice-4" value="choice-4"  />
         	<label for="radio-choice-4">Lizard</label>
    </fieldset>
</div>
        </section>
        <section data-role="footer">
            <h2>
                Footer</h2>
        </section>
    </section>
    <section id="Proposed" data-role="page">
        <section data-role="header">
            <h1>
                Header</h1>
        </section>
        <section data-role="content">
            <div data-role="navbar">
                <ul>
                    <li><a href="#Existing">Existing</a></li>
                    <li><a href="#Proposed" class="ui-btn-active ui-state-persist">Proposed</a></li>
                </ul>
            </div>
            <fieldset data-role="controlgroup" data-type="horizontal">
                <input name="r" id="r1" value="q.1 d" checked="checked" type="radio">
                <label for="r1">
                    q.1 d</label>
                <input name="r" id="r2" value="q.12 h"  type="radio">
                <label for="r2">
                    q.12 h</label>
                <input name="r" id="r3" value="q.8 h"  type="radio">
                <label for="r3">
                    q.8 h</label>
            </fieldset>
            <div id="picker">
            </div>
        </section>
        <section data-role="footer">
            <h2>
                Footer</h2>
        </section>
    </section>
    <script type="text/template" id="rx-tab-input">
        <a  href="#{{IO}}-{{MedicationType}}" data-role="button" data-rel="dialog">{{MedicationType}}</a>
        <div>
        {{#IsEmpty}}None Selected{{/IsEmpty}}
        {{#NotIsEmpty}}
        <div class="Medication">{{Rx.Medication.Name}}</div>
        <div><span class="Dose">{{Rx.Dose}}</span></div>
        <div><span class="DosesPerDay">{{Rx.DosesPerDay}}</span> per day</div>
        {{/NotIsEmpty}}
        </div>
        <input type="button" {{#IsEmpty}}disabled="disabled"{{/IsEmpty}} data-icon="delete"  id="trigger-delete-{{MedicationType}}-{{IO}}" value="Delete"data-IO="{{IO}}" data-MedicationType="{{MedicationType}}" />
    </script>
    <script type="text/template" id="template-picker">
            <div class="ui-grid-b">
                <div class="ui-block-a">
                    <input type="button" value="q.1 d" {{#isDisabled}}q.1 d{{/isDisabled}}/>
                </div>
                <div class="ui-block-b">
                   <input type="button"  value="q.12 h" {{#isDisabled}}q.12 h{{/isDisabled}}/>
                </div>
                <div class="ui-block-c">
                    <input type="button"  value="q.8 h" {{#isDisabled}}q.8 h{{/isDisabled}}/>
                </div>
                <div class="ui-block-a">
                   <input type="button"  value="q.6 h" {{#isDisabled}}q.6 h{{/isDisabled}}/>
                </div>
                <div class="ui-block-b">
                   <input type="button" value="q.4 h" {{#isDisabled}}q.4 h{{/isDisabled}}/></div>
                <div class="ui-block-c">
                    <input type="button"  value="q.3 h" {{#isDisabled}}q.3 h{{/isDisabled}}/></div>
                <div class="ui-block-a">
                   <input type="button"  value="q.2 h" {{#isDisabled}}q.2 h{{/isDisabled}}/></div>
                <div class="ui-block-b">
                   <input type="button"  value="q.1 h"  {{#isDisabled}}q.1 h{{/isDisabled}} /></div>
            </div>
    </script>
</body>
</html>
